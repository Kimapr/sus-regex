#!/bin/sh
./build || exit
export C_INCLUDE_PATH="$PWD:$C_INCLUDE_PATH"
export LD_LIBRARY_PATH="$PWD/target:$LD_LIBRARY_PATH"
export LIBRARY_PATH="$PWD/target:$LIBRARY_PATH"
gcc -O2 test.c -o target/cmogus -L"$LIBRARY_PATH" -l:amogus || exit
if [ -z "$NODEBUG" ];
then
	gdb -q \
		-iex 'set confirm no' \
		-ex 'layout asm' \
		-ex 'start' \
			target/cmogus
else
	target/cmogus
fi
